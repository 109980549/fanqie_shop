var upload=layui.upload;var layer=layui.layer;$(".pic").on("click",function(e){var parentNode=$(this).parent();parentNode.toggleClass("on")});upload.render({elem:"#upload",url:uploadurl,multiple:true,size:2097152,accept:'file',done:function(res){layer.msg(res.message);if(res.state==1){setTimeout(function(){window.location.reload()},1000)}}});$("#ConfirmChoices").on("click",function(e){if(parent.$f){var value=parent.$f.getValue(parentinputname);var list=value||[];var images=Array.from(self.document.getElementsByClassName("pic"));images.forEach(function(image){if(Array.from(image.parentNode.classList).indexOf("on")!==-1&&value.indexOf(image.src)==-1){list.push(image.src)}});parent.$f.changeField(parentinputname,list);parent.$f.closeModal()}else{var images=Array.from(self.document.getElementsByClassName("pic"));var s=[];images.forEach(function(image,index){if(Array.from(image.parentNode.classList).indexOf("on")!==-1){parent.changeIMG(parentinputname,image.src)}});var index=parent.layer.getFrameIndex(window.name);parent.layer.close(index)}});$("#deleteimg").on("click",function(e){var images=Array.from(self.document.getElementsByClassName("pic"));var list=[];images.forEach(function(image){if(Array.from(image.parentNode.classList).indexOf("on")!==-1){list.push(image.id)}});if(list==""){layer.msg("还没选择要删除的图片")}else{layer.confirm("确定删除吗？",{btn:["确定","取消"]},function(){$.post(deleteurl,{imageid:list},function(result){layer.msg(result.message);setTimeout(function(){window.location.reload()},1000)},"json")})}});$("#moveimg").on("click",function(e){var images=Array.from(self.document.getElementsByClassName("pic"));var list=[];images.forEach(function(image){if(Array.from(image.parentNode.classList).indexOf("on")!==-1){list.push(image.id)}});if(list==""){layer.msg("还没选择要移动的图片")}else{var url=moveurl+"?images="+list.join();layer.open({type:2,title:"编辑分类",shade:[0],area:["340px","365px"],anim:2,content:url,success:function(layero,index){layer.iframeAuto(index)},end:function(){}})}});$("#addcate").on("click",function(e){layer.open({type:2,title:"编辑分类",shade:[0],area:["340px","265px"],anim:2,content:addcate,success:function(layero,index){layer.iframeAuto(index)},end:function(){}})});$("#editcate").on("click",function(e){if(pid==0){layer.msg("禁止编辑")}else{layer.open({type:2,title:"编辑分类",shade:[0],area:["340px","265px"],anim:2,content:editcate,end:function(){}})}});$("#deletecate").on("click",function(e){layer.confirm("确定删除吗？",{btn:["确定","取消"]},function(){$.post(deletecate,{id:pid},function(result){layer.msg(result.message);if(result.state==1){setTimeout(function(){window.location.reload()},1000)}},"json")})});if(!parent.$f){$(".main-top").hide();$(".main").css("margin","0px")};